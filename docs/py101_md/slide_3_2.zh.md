# ç¬¬ä¸‰ç«  NumPy ä¸Ž Pandas

## ä½ å°†å­¦åˆ°ä»€ä¹ˆ

*   æ•°æ®ç»„ç»‡çš„åŸºæœ¬åŽŸåˆ™
*   Pandas åº“çš„æ ¸å¿ƒç»„ä»¶ï¼šSeries å’Œ DataFrame
*   DataFrame çš„ç»“æž„ï¼šå¯ä»¥ç†è§£ä¸ºå¸¦è¡Œç´¢å¼•å’Œåˆ—åçš„äºŒç»´ NumPy æ•°ç»„
*   æ•°æ®æå–ï¼š
    *   å¦‚ä½•æ ¹æ®è¡Œç´¢å¼•æˆ–ä½ç½®é€‰å–è¡Œæ•°æ®
    *   å¦‚ä½•æ ¹æ®åˆ—åé€‰å–åˆ—æ•°æ®
*   è¡¨æ ¼ä¿¡æ¯æ±‡æ€»ä¸Žæè¿°æ€§ç»Ÿè®¡
*   æ•°æ®æŽ’åºï¼šæ ¹æ®å€¼æˆ–ç´¢å¼•å¯¹æ•°æ®è¿›è¡ŒæŽ’åºï¼Œä»¥çªå‡ºé‡è¦ä¿¡æ¯
*   æ•°æ®èšåˆï¼šå¯¹æ•°æ®è¿›è¡Œåˆ†ç»„å’Œè®¡ç®—ï¼Œä»¥è§‚å¯Ÿæ€»ä½“è¶‹åŠ¿
*   å¤šçº§ç´¢å¼•ï¼ˆMultiIndexed DataFrameï¼‰çš„æ¦‚å¿µä¸Žä½¿ç”¨
*   ä½¿ç”¨ `loc` å’Œ `iloc` å±žæ€§è¿›è¡Œæ›´çµæ´»çš„æ•°æ®é€‰æ‹©
*   åœ¨ DataFrame ä¸­åˆ›å»ºæ–°åˆ—

## åºè¨€ â€”â€” å¤„ç†æ•°æ®

åœ¨æˆ‘ä»¬å­¦ä¹ äº†è¯¸å¤š Python åŸºç¡€çŸ¥è¯†ä¹‹åŽï¼ŒçŽ°åœ¨æˆ‘ä»¬æ­£å¼å¼€å¯å¤„ç†æ•°æ®é›†çš„æ—…ç¨‹ã€‚æ•°æ®é›†æ˜¯å­˜å‚¨æ•°æ®çš„åœ°æ–¹ã€‚ç”±äºŽå¤§å¤šæ•°æ•°æ®é›†ä»¥è¡¨æ ¼å½¢å¼å‡ºçŽ°ï¼Œå› æ­¤åœ¨æœ¬è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šå°†â€œæ•°æ®é›†â€å’Œâ€œæ•°æ®è¡¨â€è§†ä¸ºå¯äº’æ¢ä½¿ç”¨çš„æœ¯è¯­ã€‚

Pandas æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºŽåˆ†æžæ•°æ®è¡¨çš„ Python æ¨¡å—ã€‚

æ•°æ®è¡¨æ˜¯ä¿¡æ¯æœ€é‡è¦çš„è½½ä½“ä¹‹ä¸€ã€‚ä½†ä¿¡æ¯å¹¶éžæ€»æ˜¯èƒ½å¤Ÿä¸è¨€è‡ªæ˜Žï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åˆ†æžæ•°æ®ä»¥æ­ç¤ºå…¶èƒŒåŽè•´å«çš„ä¿¡æ¯ã€‚é€šè¿‡å­¦ä¹ æœ¬ç« ï¼Œä½ å°†èƒ½å¤Ÿï¼š

*   è§£é‡Šæ•°æ®è¡¨çš„ç»„ç»‡æ–¹å¼ï¼ˆå³è¡¨çš„è¡Œå’Œåˆ—åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆï¼‰ã€‚
*   åº”ç”¨ä¸€äº›åŸºæœ¬çš„æ•°æ®æ“ä½œæ–¹æ³•ä»Žè¡¨æ ¼ä¸­èŽ·å–æ‰€éœ€ä¿¡æ¯ã€‚

è¿™äº›æ“ä½œèƒ½å¸®åŠ©æˆ‘ä»¬ï¼š
*   é€šè¿‡æ”¹å˜è¡¨æ ¼çš„æ ¼å¼ï¼Œä»Žä¸åŒè§†è§’å®¡è§†æ•°æ®ã€‚
*   é€šè¿‡å®šä½ç‰¹å®šæ•°æ®ç‚¹ï¼Œå¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°ç‰¹å®šä¸ªä½“çš„ç‰¹å®šç‰¹å¾ã€‚
*   å°†æ•°æ®è¡¨åˆ’åˆ†ä¸ºæ›´å°çš„å•å…ƒï¼ˆç§°ä¸ºâ€œç»„â€ï¼‰ï¼Œå¹¶å¯¹æ¯ä¸ªç»„å†…çš„ä¿¡æ¯è¿›è¡Œæ±‡æ€»ã€‚

## åºè¨€ â€”â€” æ•°æ®ç»„ç»‡

åœ¨ç»æµŽå­¦ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†æ•°æ®ã€‚é€šè¿‡æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š
*   æ´žå¯Ÿç»æµŽä¸–ç•Œçš„è¿ä½œæ–¹å¼ã€‚
*   éªŒè¯æˆ‘ä»¬çš„ç»æµŽç†è®ºã€‚

è¿™äº›æ•°æ®å¯èƒ½åŒ…æ‹¬ä¸€ä¸ªå›½å®¶çš„ GDPã€æŸä¸ªäººçš„æ¶ˆè´¹æ˜Žç»†ã€ä¸€ä»¶å•†å“çš„ä»·æ ¼ç­‰ç­‰ã€‚éšç€è®¡ç®—èƒ½åŠ›çš„æå‡ï¼Œç»æµŽæ•°æ®å˜å¾—è¶Šæ¥è¶Šåºžå¤§ï¼ŒçŽ°åœ¨å¤„ç† GB ç”šè‡³ TB çº§åˆ«çš„çš„æ•°æ®é›†å·²å±¡è§ä¸é²œã€‚

åœ¨è®¡ç®—æœºä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å°†æ•°æ®å­˜å‚¨åœ¨è¡¨æ ¼ä¸­ã€‚è¡¨æ ¼åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šç±»ä¼¼äºŽä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œå®ƒåŒ…å«è¡Œï¼ˆæ¯ä¸ªæ°´å¹³æ–¹å‘çš„å…ƒç´ åºåˆ—ï¼‰å’Œåˆ—ï¼ˆæ¯ä¸ªåž‚ç›´æ–¹å‘çš„å…ƒç´ åºåˆ—ï¼‰ã€‚

!!! note "æ•°æ®è¡¨ç»„ç»‡çš„åŸºæœ¬åŽŸåˆ™"
    *   **æ¯ä¸€è¡Œ** ä»£è¡¨ä¸€ä¸ªè§‚æµ‹å•å…ƒï¼ˆä¾‹å¦‚ä¸€ä¸ªäººã€ä¸€ä¸ªå›½å®¶ç­‰å®žä½“ï¼‰ã€‚
    *   **æ¯ä¸€åˆ—** å±•ç¤ºäº†è§‚æµ‹å•å…ƒçš„æŸä¸ªç‰¹å®šè§†è§’æˆ–ç‰¹å¾ï¼ˆä¾‹å¦‚äººçš„èº«é«˜ã€å›½å®¶çš„ GDP ç­‰ï¼‰ã€‚
    *   **é¡¶éƒ¨çš„è¡Œ** é€šå¸¸ä¿ç•™ç”¨ä½œåˆ—åï¼Œç§°ä¸ºè¡¨å¤´ï¼ˆHeaderï¼‰ã€‚å®ƒä¸å±žäºŽè¡¨æ ¼çš„â€œå†…å®¹â€éƒ¨åˆ†ã€‚
    *   **æœ€å·¦è¾¹çš„åˆ—** é€šå¸¸ä¿ç•™ç”¨ä½œè¡Œçš„ç´¢å¼•ï¼ˆåç§°ï¼‰ã€‚å®ƒä¹Ÿä¸å±žäºŽè¡¨æ ¼çš„â€œå†…å®¹â€éƒ¨åˆ†ã€‚

## 3.1 å•åˆ—æ•°æ®ï¼šSeries

Pandas å­˜å‚¨åºåˆ—æ•°æ®çš„æ–¹å¼ä¸Ž NumPy éžå¸¸ç›¸ä¼¼ï¼šéƒ½æ˜¯ä¸€ç»´åºåˆ—ã€‚ä½†åœ¨ Pandas ä¸­ï¼Œè¿™ç§åºåˆ—è¢«ç§°ä¸º **Series**ã€‚

!!! note "Series çš„å…³é”®ç‰¹æ€§"
    *   **åŒè´¨æ€§**ï¼šä¸€ä¸ª Series ä¸­çš„æ‰€æœ‰å…ƒç´ å¿…é¡»æ˜¯ç›¸åŒçš„æ•°æ®ç±»åž‹ã€‚
    *   **å¸¦ç´¢å¼•**ï¼šSeries çš„ä¸€ä¸ªé‡è¦ç‰¹å¾æ˜¯å…¶å…ƒç´ å…·æœ‰åç§°ï¼Œè¿™äº›åç§°è¢«ç§°ä¸ºç´¢å¼•ï¼ˆindexï¼‰ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯´ï¼Œâ€œSeries ä¸­çš„æ•°æ®æ˜¯è¢«ç´¢å¼•çš„â€ã€‚

## 3.2 å¤„ç†è¡¨æ ¼æ•°æ®ï¼šDataFrame

æˆ‘ä»¬ç”¨æ¥å­˜å‚¨æ•°æ®è¡¨çš„ç±»åž‹ç§°ä¸º Pandas **DataFrame**ã€‚å®ƒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªå¸¦æœ‰è¡Œç´¢å¼•ï¼ˆindexï¼‰å’Œåˆ—åï¼ˆcolumnsï¼‰çš„çŸ©é˜µï¼š
*   `index`ï¼šåŒ…å«æ¯ä¸€è¡Œçš„åç§°ã€‚
*   `columns`ï¼šåŒ…å«æ¯ä¸€åˆ—çš„åç§°ã€‚

ä¾‹å¦‚ï¼Œåœ¨ä¸‹æ–¹çš„ç¤ºä¾‹ä»£ç ç”Ÿæˆçš„è¡¨æ ¼ä¸­ï¼Œæœ€å·¦ä¾§åŠ ç²—çš„æ•°å­—æ˜¯è¡Œç´¢å¼•ï¼Œé¡¶éƒ¨çš„åŠ ç²—å­—æ¯æ˜¯åˆ—åã€‚

```python
import pandas as pd
import numpy as np

# åˆ›å»ºä¸€ä¸ªç¤ºä¾‹ DataFrame
df1 = pd.DataFrame(
    np.random.randn(6, 4),  # 6x4 çš„ç¬¦åˆæ ‡å‡†æ­£æ€åˆ†å¸ƒ N(0,1) çš„éšæœºæ•°
    index=range(6),         # è¡Œç´¢å¼•ä¸º 0 åˆ° 5
    columns=list("ABCD")    # åˆ—åä¸º A, B, C, D
)
print(df1)
```

### 3.2.1 è¡Œä¸Žåˆ—

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¡Œç´¢å¼•åå’Œåˆ—åæ¥æŸ¥æ‰¾ï¼ˆå–å‡ºï¼‰æ•°æ®ã€‚ä½†ä¸¤è€…çš„ç´¢å¼•æ–¹å¼æœ‰æ‰€ä¸åŒï¼š

```python
# æå–ç¬¬ä¸€è¡Œ (ç»“æžœä»ç„¶æ˜¯ä¸€ä¸ª DataFrame)
row1 = df1[0:1]
print("æå–çš„ç¬¬ä¸€è¡Œ (df1[0:1]):")
print(row1)
print(type(row1))

# æå– 'A' åˆ— (ç»“æžœæ˜¯ä¸€ä¸ª Series)
col1 = df1['A']
print("\næå–çš„ 'A' åˆ— (df1['A']):")
print(col1)
print(type(col1))
```

!!! note "Series ä¸Ž DataFrame çš„å…³ç³»"
    è™½ç„¶çœ‹èµ·æ¥ç›¸ä¼¼ï¼Œä½†é€šè¿‡ `type()` å‡½æ•°æ£€æŸ¥å®ƒä»¬çš„ç±»åž‹ï¼Œä½ ä¼šå‘çŽ°è¡Œåˆ‡ç‰‡ï¼ˆå¦‚ `df1[0:1]`ï¼‰çš„ç»“æžœä»ç„¶æ˜¯ä¸€ä¸ª DataFrameï¼Œè€Œå•åˆ—é€‰æ‹©ï¼ˆå¦‚ `df1['A']`ï¼‰çš„ç»“æžœæ˜¯ä¸€ä¸ª `pandas.core.series.Series`ã€‚
    Series æ˜¯ä¸€ä¸ªç”¨äºŽå­˜å‚¨å•ä¸€ç»´åº¦ä¿¡æ¯çš„ä¸€ç»´å¯¹è±¡ã€‚è€Œ Pandas DataFrame åˆ™æ˜¯ç”±å¤šä¸ª Series æž„æˆçš„äºŒç»´æ•°æ®ç»“æž„ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å…±äº«ç›¸åŒè¡Œç´¢å¼•çš„ Series çš„é›†åˆã€‚

DataFrame ä¸ºæˆ‘ä»¬æä¾›äº†ç»“æž„åŒ–çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `describe()` æ–¹æ³•èŽ·å–æ¯ä¸€åˆ—çš„æè¿°æ€§ç»Ÿè®¡ä¿¡æ¯ï¼Œä½¿ç”¨ `dtypes` å±žæ€§èŽ·å–å„åˆ—çš„æ•°æ®å­˜å‚¨ç±»åž‹ã€‚

```python
# åˆ›å»ºå¦ä¸€ä¸ªç¤ºä¾‹ DataFrame
df2 = pd.DataFrame(
    [[1, 2], [1.1, 2.1]],
    index=range(2),
    columns=['col1', 'col2']
)
print("\nDataFrame df2:")
print(df2)

print("\ndf2 å„åˆ—çš„æ•°æ®ç±»åž‹:")
print(df2.dtypes)

print("\ndf2 å„åˆ—çš„æè¿°æ€§ç»Ÿè®¡:")
print(df2.describe())
```

!!! info "æ•°æ®ç±»åž‹æç¤º"
    åœ¨ `df2` ä¸­ï¼Œ`col1` åˆ—æ··åˆäº†æ•´æ•° `1` å’Œæµ®ç‚¹æ•° `1.1`ã€‚Pandas ä¸ºäº†ä¿æŒåˆ—ä¸­æ•°æ®ç±»åž‹çš„ä¸€è‡´æ€§ï¼Œä¼šå°†è¯¥åˆ—çš„æ•´ä½“æ•°æ®ç±»åž‹è§†ä¸ºæµ®ç‚¹åž‹ï¼ˆ`float64`ï¼‰ï¼Œå³ä½¿å…¶ä¸­æŸäº›å€¼æœ€åˆæ˜¯ä»¥æ•´æ•°å½¢å¼è¾“å…¥çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ `df2.dtypes` çš„è¾“å‡ºä¸­ï¼Œ`col1` å¯èƒ½æ˜¯ `float64` ç±»åž‹ã€‚

### 3.2.2 æŽ’åºä¸Žèšåˆ

æˆ‘ä»¬å¯ä»¥ä»Žä¸åŒçš„è§’åº¦å®¡è§†ä¸€ä¸ªæ•°æ®è¡¨ã€‚è™½ç„¶ä¿¡æ¯æœ¬èº«ä¸ä¼šæ”¹å˜ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡æŽ’åºå’Œèšåˆç­‰æ–¹å¼ï¼Œçªå‡ºæ˜¾ç¤ºæˆ‘ä»¬æ›´æ„Ÿå…´è¶£çš„ä¿¡æ¯ã€‚

**æŽ’åº (Sorting)**

é«˜äº®ä¿¡æ¯çš„ç¬¬ä¸€ç§æ–¹æ³•æ˜¯å°†æœ€é‡è¦çš„ä¿¡æ¯æ”¾åœ¨è¡¨æ ¼çš„é¡¶éƒ¨ã€‚è¿™å¯ä»¥é€šè¿‡ `sort_values()` æ–¹æ³•ï¼ˆæŒ‰å€¼æŽ’åºï¼‰æˆ– `sort_index()` æ–¹æ³•ï¼ˆæŒ‰ç´¢å¼•æŽ’åºï¼‰æ¥å®žçŽ°ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªæŽ’åºçš„ä¾‹å­ï¼š

```python
# ç¤ºä¾‹ï¼šæ¯”èµ›å¾—åˆ†æ•°æ®
race_score_data = {'é€‰æ‰‹': ['Alice', 'Bob', 'Charlie'], 'å¾—åˆ†': [15.6, 17.3, 14.5]}
race_score = pd.DataFrame(race_score_data)
print("åŽŸå§‹æ¯”èµ›å¾—åˆ†:")
print(race_score)

# æŒ‰ç¬¬äºŒåˆ—ï¼ˆ'å¾—åˆ†'ï¼Œåˆ—ç´¢å¼•ä¸º1ï¼Œå¦‚æžœç”¨åˆ—ååˆ™æ˜¯ 'å¾—åˆ†'ï¼‰å‡åºæŽ’åº
# æ³¨æ„ï¼šå¦‚æžœ DataFrame åˆå§‹åŒ–æ—¶æ²¡æœ‰æ˜¾å¼æŒ‡å®šåˆ—åï¼Œè€Œæ˜¯ç”¨çš„é»˜è®¤æ•°å­—åˆ—åï¼Œåˆ™å¯ä»¥ç”¨æ•°å­—ã€‚
# race_score.sort_values(by=1, ascending=True) # å¦‚æžœåˆ—åä¸º 0, 1
# æ›´æŽ¨èçš„æ–¹å¼æ˜¯ä½¿ç”¨åˆ—å:
race_score_sorted_by_value = race_score.sort_values(by='å¾—åˆ†', ascending=True)
print("\næŒ‰å¾—åˆ†å‡åºæŽ’åºåŽ:")
print(race_score_sorted_by_value)

# ä¿®æ”¹è¡Œç´¢å¼•å¹¶æŒ‰è¡Œç´¢å¼•æŽ’åº
race_score.index = [1002, 1001, 1003]
print("\nä¿®æ”¹è¡Œç´¢å¼•åŽ:")
print(race_score)

race_score_sorted_by_index = race_score.sort_index()
print("\næŒ‰è¡Œç´¢å¼•å‡åºæŽ’åºåŽ:")
print(race_score_sorted_by_index)
```

**èšåˆ (Aggregation)**

å½“æˆ‘ä»¬æƒ³è¦å¯¹è¡¨æ ¼æ•°æ®è¿›è¡Œé¸Ÿçž°å¼è§‚å¯Ÿï¼Œäº†è§£å…¶æ€»ä½“ç‰¹å¾æ—¶ï¼Œæˆ‘ä»¬ä¼šè¿›è¡Œä¿¡æ¯æ±‡æ€»ï¼Œå³èšåˆã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¸å†å…³æ³¨å•ä¸ªæ•°æ®ç‚¹çš„ç»†èŠ‚ï¼Œè€Œæ˜¯...
## 3.2 å¤„ç†å•ä¸ªè¡¨æ ¼

### 3.2.1 DataFrame åŸºæœ¬å±žæ€§ä¸Žæ¦‚è§ˆ

åœ¨æ·±å…¥äº†è§£è¡¨æ ¼æ•°æ®çš„å…·ä½“æ“ä½œä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å¦‚ä½•èŽ·å– DataFrame çš„åŸºæœ¬ä¿¡æ¯ã€‚

*   ä½¿ç”¨ `describe()` æ–¹æ³•å¯ä»¥èŽ·å–æ•°æ®çš„æè¿°æ€§ç»Ÿè®¡ä¿¡æ¯ï¼Œå¦‚è®¡æ•°ã€å‡å€¼ã€æ ‡å‡†å·®ã€æœ€å°å€¼ã€æœ€å¤§å€¼å’Œå››åˆ†ä½æ•°ç­‰ã€‚
*   é€šè¿‡ `.dtypes` å±žæ€§å¯ä»¥æŸ¥çœ‹ DataFrame ä¸­æ¯ä¸€åˆ—çš„æ•°æ®ç±»åž‹ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªåˆ›å»º DataFrame å¹¶æŸ¥çœ‹å…¶å±žæ€§çš„ç®€å•ç¤ºä¾‹ï¼š

```python
import pandas as pd
import numpy as np # é€šå¸¸ä¸Ž pandas ä¸€èµ·ä½¿ç”¨

# åˆ›å»ºä¸€ä¸ªç¤ºä¾‹ DataFrame
df2 = pd.DataFrame([[1, 2], [1.1, 2.1]],
                   index=range(2),
                   columns=['col1', 'col2'])

# æŸ¥çœ‹æ•°æ®ç±»åž‹
print("æ•°æ®ç±»åž‹ (dtypes):")
print(df2.dtypes)

# æŸ¥çœ‹æè¿°æ€§ç»Ÿè®¡
print("\næè¿°æ€§ç»Ÿè®¡ (describe):")
print(df2.describe())
```

### 3.2.2 æŽ’åºä¸Žèšåˆ

å½“æˆ‘ä»¬æƒ³è¦å¯¹è¡¨æ ¼æ•°æ®è¿›è¡Œé¸Ÿçž°å¼è§‚å¯Ÿï¼Œäº†è§£å…¶æ€»ä½“ç‰¹å¾æ—¶ï¼Œæˆ‘ä»¬ä¼šè¿›è¡Œä¿¡æ¯æ±‡æ€»ï¼Œå³èšåˆã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¸å†å…³æ³¨å•ä¸ªæ•°æ®ç‚¹çš„ç»†èŠ‚ï¼Œè€Œæ˜¯å¸Œæœ›äº†è§£æ•°æ®çš„æ•´ä½“æƒ…å†µã€‚

#### çªå‡ºæ˜¾ç¤ºä¿¡æ¯ï¼šæŽ’åº
æˆ‘ä»¬å¯ä»¥ä»Žä¸åŒè§’åº¦å®¡è§†è¡¨æ ¼ã€‚å°½ç®¡ä¿¡æ¯å†…å®¹æœ¬èº«ä¸ä¼šæ”¹å˜ï¼Œä½†æˆ‘ä»¬å¯ä»¥çªå‡ºæ˜¾ç¤ºæˆ‘ä»¬æ›´æ„Ÿå…´è¶£çš„ä¿¡æ¯ã€‚ç¬¬ä¸€ç§çªå‡ºæ˜¾ç¤ºçš„æ–¹æ³•æ˜¯å°†æœ€é‡è¦çš„ä¿¡æ¯æ”¾åœ¨è¡¨æ ¼çš„é¡¶éƒ¨ï¼Œè¿™å¯ä»¥é€šè¿‡ `.sort_values()` (æŒ‰å€¼æŽ’åº) æˆ– `.sort_index()` (æŒ‰ç´¢å¼•æŽ’åº) æ–¹æ³•å®žçŽ°ã€‚

ä¸€ä¸ªæŽ’åºçš„ä¾‹å­ï¼š
```python
# å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ¯”èµ›å¾—åˆ†çš„ DataFrame
race_score = pd.DataFrame([
    ['Alice', 15.6],
    ['Bob', 17.3],
    ['Charlie', 14.5]
], columns=['Name', 'Score']) # ä¸ºåˆ—æŒ‡å®šåç§°ä»¥ä¾¿äºŽç†è§£

# æŒ‰ 'Score' åˆ— (åŽŸä¸ºç´¢å¼•1) å‡åºæŽ’åº
print("æŒ‰åˆ†æ•°å‡åºæŽ’åº:")
print(race_score.sort_values(by='Score', ascending=True))

# ä¿®æ”¹ç´¢å¼•å¹¶æŒ‰ç´¢å¼•æŽ’åº
race_score.index = [1002, 1001, 1003]
print("\næŒ‰æ–°ç´¢å¼•æŽ’åº:")
print(race_score.sort_index())
```

#### ä¿¡æ¯æ±‡æ€»ï¼šèšåˆ
å½“æˆ‘ä»¬å¸Œæœ›å¯¹è¡¨æ ¼æ•°æ®è¿›è¡Œé¸Ÿçž°å¼è§‚å¯Ÿæ—¶ï¼Œæˆ‘ä»¬ä¼šè¿›è¡Œä¿¡æ¯æ±‡æ€»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸å†å…³æ³¨å•ä¸ªæ•°æ®è®°å½•çš„ç»†èŠ‚ï¼Œè€Œæ˜¯æƒ³äº†è§£æ•°æ®çš„æ•´ä½“é¢è²Œã€‚è¿™ç§æ±‡æ€»æ“ä½œå¯ä»¥é€šè¿‡ `.agg()` æ–¹æ³•å®Œæˆã€‚

ä¸€ä¸ªèšåˆçš„ä¾‹å­ï¼š
```python
student_name = ['Alice', 'Bob', 'Charlie', 'David', 'Eva']
language_score = [99, 100, 35, 60, 71]
math_score = [25, 89, 36, 40, 91]

score = pd.DataFrame(
    np.array([language_score, math_score]).T, # .T è½¬ç½®æ•°ç»„ä½¿æˆç»©æˆä¸ºåˆ—
    index=student_name,
    columns=['language', 'math'] # æ³¨æ„ï¼šåŽŸæ–‡ä¸­ 'mathâ€™ åº”ä¸º 'math'
)
print("åŽŸå§‹åˆ†æ•°è¡¨:")
print(score)

# è®¡ç®—æ¯é—¨è¯¾ç¨‹çš„å¹³å‡åˆ† (axis=0 è¡¨ç¤ºæŒ‰åˆ—æ“ä½œ)
print("\nå„ç§‘ç›®å¹³å‡åˆ†:")
print(score.agg("mean", axis=0))

# è®¡ç®—æ¯ä¸ªå­¦ç”Ÿçš„æ€»åˆ† (axis=1 è¡¨ç¤ºæŒ‰è¡Œæ“ä½œ)
print("\næ¯ä½å­¦ç”Ÿæ€»åˆ†:")
print(score.agg("sum", axis=1))
```

#### è¯»å–CSVæ–‡ä»¶
Pandas æä¾›äº†ä¸€ä¸ªéžå¸¸ç®€æ´å’Œå¼ºå¤§çš„ API æ¥è¯»å– CSV æ–‡ä»¶ï¼š`pd.read_csv()` å‡½æ•°ã€‚è¿™æ˜¯å¤„ç†è¡¨æ ¼æ•°æ®çš„ç¬¬ä¸€æ­¥ã€‚

```python
# ç¤ºä¾‹ï¼šè¯»å– iris æ•°æ®é›†
# å‡è®¾ iris.data æ–‡ä»¶ä½äºŽåŒçº§ç›®å½•ä¸‹çš„ iris æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ä¸”æ²¡æœ‰è¡¨å¤´
# irisdata = pd.read_csv("./iris/iris.data", header=None)
# print(irisdata.head()) # æ‰“å°å‰5è¡ŒæŸ¥çœ‹æ•°æ®æ˜¯å¦åŠ è½½æˆåŠŸ
```
!!! note "æ–‡ä»¶è·¯å¾„æç¤º"
    åœ¨å®žé™…è¿è¡Œ `pd.read_csv()` æ—¶ï¼Œè¯·ç¡®ä¿æ–‡ä»¶è·¯å¾„ `"./iris/iris.data"` æ˜¯æ­£ç¡®çš„ï¼Œæˆ–è€…æ ¹æ®æ‚¨çš„æ–‡ä»¶å®žé™…ä½ç½®è¿›è¡Œä¿®æ”¹ã€‚

!!! question "è¯¾å ‚ç»ƒä¹  1ï¼šé¸¢å°¾èŠ±æ•°æ®å¤„ç†"
    1.  è¯»å–æ•°æ® `./iris/iris.data` (å‡è®¾æ–‡ä»¶æ— è¡¨å¤´) å¹¶å¿«é€ŸæŸ¥çœ‹ã€‚åˆ—åæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆæç¤ºï¼šå¯ä»¥ä½¿ç”¨ `.head()` å’Œ `.columns`ï¼‰
    2.  å°†åˆ—åæ›´æ”¹ä¸º `"sepal_length"`, `"sepal_width"`, `"petal_length"`, `"petal_width"`, å’Œ `"class"` (åŽŸ `type` å¯èƒ½ä¼šä¸Ž Python å…³é”®å­—å†²çªï¼Œå»ºè®®ç”¨ `class` æˆ– `species`)ã€‚
    3.  ç§»é™¤æœ€åŽä¸€åˆ— `"class"` (æç¤º: æœ‰ä¸€ä¸ªåä¸º `drop` çš„æ–¹æ³•)ã€‚
    4.  è®¡ç®—å‰å››åˆ— (èŠ±è¼é•¿åº¦ã€èŠ±è¼å®½åº¦ã€èŠ±ç“£é•¿åº¦ã€èŠ±ç“£å®½åº¦) ä¸­æ¯ä¸€åˆ—çš„å¹³å‡å€¼å’Œæ ‡å‡†å·®ï¼ˆä½¿ç”¨èšåˆæ–¹æ³•ï¼‰ã€‚
    5.  å¯¹å‰å››åˆ—è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼šä»Žæ¯ä¸ªç›¸åº”åˆ—ä¸­å‡åŽ»è¯¥åˆ—çš„å¹³å‡å€¼ï¼Œç„¶åŽé™¤ä»¥å…¶æ ‡å‡†å·®ã€‚æ–°çš„ DataFrame åº”ç§°ä¸º `"irisdata_normed"`ã€‚
    6.  æ£€æŸ¥ `irisdata_normed` çš„å¹³å‡å€¼å’Œæ ‡å‡†å·® (ç†è®ºä¸Šå‡å€¼åº”æŽ¥è¿‘0ï¼Œæ ‡å‡†å·®åº”æŽ¥è¿‘1)ã€‚
    7.  å°†å¤„ç†åŽçš„æ•°æ® `irisdata_normed` å†™å…¥ä¸€ä¸ªæ–°çš„ `.csv` æ–‡ä»¶ (ä½¿ç”¨ `.to_csv()` æ–¹æ³•)ï¼Œä¾‹å¦‚ `iris_normed.csv`ï¼Œå¹¶ä¸”ä¸åŒ…å«ç´¢å¼•ã€‚

### 3.2.3 å †å ä¸Žæ‹†åˆ† (`.stack()` å’Œ `.unstack()`)
å‰é¢çš„å°èŠ‚ (ä¾‹å¦‚ 3.2.2 ä¸­å…³äºŽæŽ’åºå’Œèšåˆçš„è®¨è®º) ä¸»è¦å…³æ³¨å¦‚ä½•æ”¹å˜æ•°æ®å†…å®¹çš„å‘ˆçŽ°æ–¹å¼æˆ–è¿›è¡Œæ±‡æ€»ï¼Œä½†æˆ‘ä»¬åŸºæœ¬ä¸Šä¿æŒäº†åŽŸæœ‰çš„è¡Œä½œä¸ºè¡Œã€åˆ—ä½œä¸ºåˆ—çš„ç»“æž„ï¼ˆæ²¡æœ‰è¿›è¡Œè¡Œå’Œåˆ—ä¹‹é—´çš„æ ¹æœ¬æ€§è½¬ç½®æˆ–äº¤æ¢ï¼‰ã€‚

çªå‡ºæ˜¾ç¤ºæˆ‘ä»¬æ„Ÿå…´è¶£çš„æ•°æ®çš„ç¬¬äºŒç§é‡è¦æ–¹æ³•æ˜¯é€šè¿‡**äº¤æ¢è¡Œå’Œåˆ—çš„å±‚çº§**ã€‚è¿™ä¸ä»…æ˜¯ä¸€ç§æ•°æ®é‡å¡‘æŠ€å·§ï¼Œä¹Ÿæ˜¯ä¸€ç§åœ¨ä¸æ”¹å˜å†…å®¹å€¼ï¼ˆä¸Žèšåˆä¸åŒï¼‰çš„æƒ…å†µä¸‹ç»„ç»‡æ•°æ®çš„é‡è¦æ–¹å¼ã€‚è¿™å¯ä»¥é€šè¿‡ `.stack()` å’Œ `.unstack()` æ–¹æ³•å®žçŽ°ã€‚

*   `.stack()`: å°† DataFrame çš„åˆ—â€œå †å â€åˆ°è¡Œï¼Œå³å°†åˆ—ç´¢å¼•è½¬æ¢ä¸ºè¡Œç´¢å¼•ï¼Œé€šå¸¸ä¼šäº§ç”Ÿä¸€ä¸ª Series (å¦‚æžœåŽŸå§‹åˆ—ç´¢å¼•åªæœ‰ä¸€å±‚) æˆ–ä¸€ä¸ªå…·æœ‰æ›´æ·±å±‚çº§è¡Œç´¢å¼•çš„ DataFrameã€‚
*   `.unstack()`: `.stack()` çš„é€†æ“ä½œï¼Œå°†è¡Œç´¢å¼•çš„æŸä¸ªå±‚çº§â€œæ‹†åˆ†â€åˆ°åˆ—ç´¢å¼•ã€‚

DataFrame ä¸­çš„ç´¢å¼•å‘æˆ‘ä»¬å±•ç¤ºäº†å…³äºŽä¸ªä½“èº«ä»½çš„ä¿¡æ¯ï¼Œä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰å¤šå±‚çº§çš„èº«ä»½ä¿¡æ¯ï¼ˆMultiIndexï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸€å¹´çº§ä¸€ç­æœ‰ä¸€ä¸ª Aliceï¼Œä¸‰å¹´çº§äºŒç­å¯èƒ½ä¹Ÿæœ‰ä¸€ä¸ª Aliceã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¤šé‡ç´¢å¼•æ¥å¸®åŠ©å”¯ä¸€è¯†åˆ«ä¸€ä¸ªæ•°æ®ç‚¹ã€‚

è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬ä»Žä¸åŒå¹´çº§ã€ä¸åŒç­çº§é€‰æ‹©ä¸€åå­¦ç”Ÿï¼Œå¹¶è®°å½•ä»–ä»¬çš„èº«é«˜å’Œä½“é‡ã€‚

```python
# å®šä¹‰å¤šå±‚ç´¢å¼•çš„å„ä¸ªçº§åˆ«
arrays = [
    ["first", "first", "second", "second", "third", "third", "fourth", "fourth"], # å¹´çº§
    ["one", "two", "one", "two", "one", "two", "one", "two"], # ç­çº§
]

# å¯¹åº”çš„æ•°æ®ï¼šèº«é«˜å’Œä½“é‡
height_weight = np.array([
    [173, 176, 185, 167, 165, 193, 156, 163],  # èº«é«˜
    [130, 190, 180, 170, 170, 200, 100, 105]   # ä½“é‡
]).T # è½¬ç½®ä½¿å¾—æ¯è¡Œä»£è¡¨ä¸€ä¸ªå­¦ç”Ÿï¼Œæ¯åˆ—ä»£è¡¨èº«é«˜æˆ–ä½“é‡

# åˆ›å»ºå¤šå±‚ç´¢å¼•å¯¹è±¡
# å‚è€ƒ: https://pandas.pydata.org/docs/reference/api/pandas.MultiIndex.from_arrays.html
myindex = pd.MultiIndex.from_arrays(arrays, names=["grade", "class"])

# åˆ›å»ºå¸¦æœ‰MultiIndexçš„DataFrame
student_info = pd.DataFrame(height_weight,
                            index=myindex,
                            columns=["height", "weight"])
print("åŽŸå§‹ DataFrame (student_info):")
print(student_info)

# ä½¿ç”¨ stack() å°†åˆ—è½¬æ¢ä¸ºè¡Œç´¢å¼•çš„æœ€å†…å±‚
# ç»“æžœé€šå¸¸æ˜¯ä¸€ä¸ª Seriesï¼Œå…¶ç´¢å¼•æ˜¯ (grade, class, original_column_name)
stacked_info = student_info.stack()
print("\nStack ä¹‹åŽ (stacked_info):")
print(stacked_info)

# ä½¿ç”¨ unstack() å¯ä»¥å°†è¡Œç´¢å¼•çš„ç‰¹å®šå±‚çº§è½¬æ¢å›žåˆ—ç´¢å¼•
# ä¾‹å¦‚ï¼Œå°† stacked_info ä¸­ä»£è¡¨åŽŸåˆ—å ('height', 'weight') çš„å±‚çº§ (é»˜è®¤æœ€å†…å±‚, çº§åˆ«-1) unstack å›žåŽ»
unstacked_original = stacked_info.unstack()
print("\nUnstack é»˜è®¤å±‚çº§ (æ¢å¤åŽŸçŠ¶):")
print(unstacked_original)

# ä¹Ÿå¯ä»¥ unstack å¤šå±‚ï¼Œä¾‹å¦‚ï¼Œå°† 'class' (çº§åˆ«1) å’ŒåŽŸåˆ—åå±‚çº§ (çº§åˆ«2, stackåŽäº§ç”Ÿçš„) è½¬æ¢å›žåˆ—
# student_info.stack().unstack([1,2]) è¿™ç§è°ƒç”¨æ–¹å¼éœ€è¦Seriesçš„ç´¢å¼•æœ‰è¶³å¤Ÿå¤šçš„å±‚çº§
# æˆ–è€…ï¼Œå¯¹åŽŸå§‹ student_info è¿›è¡Œæ“ä½œ
# å…ˆ stackï¼Œç„¶åŽ unstack 'class' å±‚çº§ (ç´¢å¼•ä¸­çš„ç¬¬1å±‚)
unstacked_class = student_info.stack().unstack(level='class')
print("\nStack åŽå† Unstack 'class' å±‚çº§:")
print(unstacked_class)

# ä¹Ÿå¯ä»¥å¯¹ student_info ç›´æŽ¥ unstackï¼Œä½†è¿™é€šå¸¸ç”¨äºŽè¡Œç´¢å¼•å±‚çº§å¾ˆå¤šçš„æƒ…å†µ
# ä¾‹å¦‚ï¼Œå¦‚æžœæƒ³æŠŠ 'class' å˜æˆåˆ—çš„ä¸€ä¸ªå±‚çº§ï¼š
# print("\nUnstacking 'class' from student_info:")
# print(student_info.unstack(level='class'))
```

### 3.2.4 åŸºäºŽæ ‡ç­¾å’Œä½ç½®çš„é€‰æ‹© (`.loc` å’Œ `.iloc`)
ä»Ž DataFrame ä¸­æå–è¡Œå’Œåˆ—çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨æ–¹æ‹¬å· `[]`ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹å¼åœ¨å¤æ‚åœºæ™¯ä¸‹å­˜åœ¨ä¸€äº›å±€é™æ€§ï¼š
*   å¯¹äºŽè¡Œå’Œåˆ—çš„é€‰æ‹©ï¼Œå¯èƒ½éœ€è¦ä¸åŒçš„è¯­æ³•æˆ–æ­¥éª¤ã€‚
*   ç›´æŽ¥ç”¨ `[]` é€‰æ‹©å¤šè¡Œï¼ˆé€šè¿‡æ ‡ç­¾åˆ—è¡¨ï¼‰ä¸ç›´è§‚ï¼Œé€šå¸¸ `df[['col1', 'col2']]` æ˜¯é€‰æ‹©åˆ—ã€‚
*   ç”¨ `[]` å¯¹åˆ—è¿›è¡Œåˆ‡ç‰‡æ“ä½œä¸ç›´æŽ¥æ”¯æŒ (ä¾‹å¦‚ `df[:, 1:3]` é€šå¸¸ä¸å·¥ä½œï¼Œæˆ–è¡Œä¸ºä¸ç¬¦åˆé¢„æœŸ)ã€‚
*   å¤æ‚çš„å¤šæ­¥é€‰æ‹©ï¼ˆé«˜çº§é€‰æ‹©ï¼‰å®¹æ˜“å› è¿”å›žè§†å›¾ï¼ˆviewï¼‰æˆ–å‰¯æœ¬ï¼ˆcopyï¼‰çš„ä¸ç¡®å®šæ€§è€Œå¼•å‘ `SettingWithCopyWarning` æˆ–éš¾ä»¥è°ƒè¯•çš„é”™è¯¯ã€‚

ä¸ºäº†æ›´æ¸…æ™°ã€æ›´å¥å£®åœ°é€‰æ‹©æ•°æ®ï¼ŒPandas æä¾›äº†ä¸¤ä¸ªä¸»è¦çš„åŸºäºŽç´¢å¼•çš„è®¿é—®å™¨ï¼š
*   `.loc[]`: **L**abel-based **o**peration **c**ollector. ç”¨äºŽåŸºäºŽæ ‡ç­¾ï¼ˆè¡Œç´¢å¼•åå’Œåˆ—åï¼‰é€‰æ‹©æ•°æ®ã€‚å¯ä»¥æŽ¥å—å•ä¸ªæ ‡ç­¾ã€æ ‡ç­¾åˆ—è¡¨ã€æ ‡ç­¾åˆ‡ç‰‡ã€å¸ƒå°”æ•°ç»„ç­‰ã€‚
*   `.iloc[]`: **I**nteger **l**ocation-based **o**peration **c**ollector. ç”¨äºŽåŸºäºŽæ•´æ•°ä½ç½®ï¼ˆä»Ž0å¼€å§‹çš„è¡Œå·å’Œåˆ—å·ï¼‰é€‰æ‹©æ•°æ®ã€‚å¯ä»¥æŽ¥å—å•ä¸ªæ•´æ•°ã€æ•´æ•°åˆ—è¡¨ã€æ•´æ•°åˆ‡ç‰‡ã€å¸ƒå°”æ•°ç»„ç­‰ã€‚

!!! note "å…³é”®åŒºåˆ«"
    `.loc` ä½¿ç”¨çš„æ˜¯ DataFrame ç´¢å¼•å’Œåˆ—çš„**åç§°/æ ‡ç­¾**ã€‚
    `.iloc` ä½¿ç”¨çš„æ˜¯ DataFrame ç´¢å¼•å’Œåˆ—çš„**æ•´æ•°ä½ç½®**ã€‚
    åˆ‡ç‰‡æ“ä½œæ—¶ï¼Œ`.loc` çš„ç»“æŸç‚¹æ˜¯**åŒ…å«**çš„ï¼Œè€Œ `.iloc` çš„ç»“æŸç‚¹æ˜¯**ä¸åŒ…å«**çš„ï¼ˆä¸Ž Python åˆ—è¡¨åˆ‡ç‰‡ä¸€è‡´ï¼‰ã€‚

```python
# ç»§ç»­ä½¿ç”¨ä¸Šä¸€èŠ‚çš„ student_info DataFrame
# print("åŽŸå§‹ DataFrame (student_info):")
# print(student_info)

# ä½¿ç”¨ .loc é€‰æ‹©æ ‡ç­¾ä¸º ('second', 'one') çš„è¡Œå’Œ 'height' åˆ—
val_loc = student_info.loc[('second', 'one'), 'height']
print(f"\nstudent_info.loc[('second', 'one'), 'height']: {val_loc}")

# ä½¿ç”¨ .iloc é€‰æ‹©ç¬¬3è¡Œ (æ•´æ•°ä½ç½®ä¸º2) å’Œç¬¬1åˆ— (æ•´æ•°ä½ç½®ä¸º0)
# student_info ä¸­ ('second', 'one') å¯¹åº”çš„æ˜¯ç´¢å¼•ä¸º2çš„è¡Œ, 'height' æ˜¯ç´¢å¼•ä¸º0çš„åˆ—
val_iloc = student_info.iloc[2, 0]
print(f"student_info.iloc[2, 0]: {val_iloc}") # è¿™åº”è¯¥ä¸Žä¸Šé¢çš„ val_loc ç›¸åŒ

# ä½¿ç”¨ .loc å’Œ lambda å‡½æ•°è¿›è¡Œæ¡ä»¶é€‰æ‹©
# é€‰æ‹© 'height' å¤§äºŽ 160 ä¸”å°äºŽ 180 çš„æ‰€æœ‰è¡Œå’Œæ‰€æœ‰åˆ—
# lambda df: ... ä¸­çš„ df æŒ‡ä»£ student_info æœ¬èº«
conditional_loc = student_info.loc[lambda df: (df['height'] > 160) & (df['height'] < 180), :]
print("\næ¡ä»¶é€‰æ‹© (èº«é«˜ > 160 ä¸” < 180):")
print(conditional_loc)

# .loc ä¹Ÿå¯ä»¥ç”¨äºŽé€‰æ‹©å¤šè¡Œå¤šåˆ—
# ä¾‹å¦‚ï¼Œé€‰æ‹© 'first' å¹´çº§çš„æ‰€æœ‰å­¦ç”Ÿçš„èº«é«˜å’Œä½“é‡
first_grade_data = student_info.loc['first'] # MultiIndex æ”¯æŒéƒ¨åˆ†é€‰æ‹©
print("\n'first' å¹´çº§å­¦ç”Ÿæ•°æ®:")
print(first_grade_data)

# é€‰æ‹© 'Alice' å’Œ 'Bob' çš„ 'math' æˆç»© (ä½¿ç”¨ä¹‹å‰ score DataFrame çš„ä¾‹å­)
# print("\nAlice å’Œ Bob çš„æ•°å­¦æˆç»©:")
# print(score.loc[['Alice', 'Bob'], 'math'])

# ä½¿ç”¨ .iloc é€‰æ‹©å‰3è¡Œå’Œå‰2åˆ—
# print("\nscore DataFrame çš„å‰3è¡Œï¼Œå‰2åˆ— (iloc):")
# print(score.iloc[0:3, 0:2]) # è¡Œ0,1,2 å’Œ åˆ—0,1
```

!!! info "æ”¶å…¥æ•°æ®ç¤ºä¾‹èƒŒæ™¯"
    æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åº”ç”¨æ‰€å­¦çŸ¥è¯†å¤„ç†ä¸€ä¸ªå…³äºŽæ”¶å…¥ä¸Žæ¶ˆè´¹æ•°æ®çš„å®žé™…æ¡ˆä¾‹ã€‚

!!! question "è¯¾å ‚ç»ƒä¹  2ï¼šæ”¶å…¥ä¸Žæ¶ˆè´¹æ•°æ®åˆ†æž"
    1.  æ–‡ä»¶ `income.csv` å’Œ `consumption.csv` åŒ…å«äº†å„çœï¼ˆå¸‚ã€è‡ªæ²»åŒºï¼‰åœ¨ä¸åŒå¹´ä»½çš„äººå‡æ”¶å…¥å’Œäººå‡æ¶ˆè´¹æ•°æ®ï¼Œä»¥åŠç›¸åº”çš„äººå£æ•°é‡ã€‚
    2.  è¯·åˆ†åˆ«è¯»å–è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚ç„¶åŽï¼Œä¸ºæ¯ä¸ª DataFrame åˆ›å»ºæ–°åˆ—ï¼Œä»¥è®¡ç®—æ¯ä¸ªçœä»½åœ¨æ¯å¹´çš„**æ€»æ”¶å…¥**å’Œ**æ€»æ¶ˆè´¹**ã€‚è®¡ç®—åŽï¼Œå°†è¿™ä¸¤ä¸ª DataFrame åˆ†åˆ«å¦å­˜ä¸ºæ–°æ–‡ä»¶ï¼Œä¾‹å¦‚ `income_total.csv` å’Œ `consumption_total.csv`ã€‚ï¼ˆæ€è€ƒï¼šæ€»æ”¶å…¥/æ€»æ¶ˆè´¹çš„å•ä½æ˜¯ä»€ä¹ˆï¼Ÿï¼‰
    3.  ä½ å°†å¦‚ä½•è®¡ç®—å„çœå„å¹´çš„**å‚¨è“„é¢**å’Œ**å‚¨è“„çŽ‡**ï¼Ÿï¼ˆå‚¨è“„é¢å®šä¹‰ä¸ºæ€»æ”¶å…¥å‡åŽ»æ€»æ¶ˆè´¹ï¼Œå‚¨è“„çŽ‡å®šä¹‰ä¸ºå‚¨è“„é¢å æ€»æ”¶å…¥çš„ç™¾åˆ†æ¯”ï¼‰ã€‚å¦‚æžœè®©ä½ å°†è¿™äº›ä¿¡æ¯åˆå¹¶åˆ°ä¸€ä¸ªæ–°çš„ DataFrame ä¸­ï¼Œä½ ä¼šå¦‚ä½•æ“ä½œï¼Ÿ(æç¤º: å¯èƒ½éœ€è¦åˆå¹¶æ“ä½œ)

### 3.2.5 æ•°æ®ç§»ä½ä¸Žç”Ÿäº§å‡½æ•°åº”ç”¨

!!! info "ç”Ÿäº§å‡½æ•°æ•°æ®ç¤ºä¾‹èƒŒæ™¯"
    åœ¨å¤„ç†æ—¶é—´åºåˆ—æ•°æ®ï¼Œç‰¹åˆ«æ˜¯ç»æµŽå­¦ä¸­çš„ç”Ÿäº§å‡½æ•°æ¨¡åž‹åˆ†æžæ—¶ï¼Œç»å¸¸éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ—¶é—´ä¸Šçš„å¯¹é½æ“ä½œã€‚ä¾‹å¦‚ï¼Œå½“æœŸçš„äº§å‡ºå¯èƒ½æ˜¯ç”±ä¸Šä¸€æœŸçš„èµ„æœ¬æŠ•å…¥å†³å®šçš„ã€‚

å¤„ç†å•ä¸ªæ•°æ®é›†æ—¶ï¼Œå¦ä¸€ä¸ªéžå¸¸æœ‰ç”¨çš„æ“ä½œæ˜¯æ•°æ®çš„**è¶…å‰ (lead) / æ»žåŽ (lag)**ã€‚è¿™å¯ä»¥é€šè¿‡ Pandas ä¸­çš„ `.shift()` æ–¹æ³•å®žçŽ°ã€‚è¯¥æ–¹æ³•å¯ä»¥å°†æ•°æ®æ²¿ç€æŒ‡å®šçš„è½´ï¼ˆé»˜è®¤ä¸ºè¡Œè½´ï¼‰ç§»åŠ¨æŒ‡å®šçš„æœŸæ•°ã€‚

è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæŸ¯å¸ƒ-é“æ ¼æ‹‰æ–¯ç”Ÿäº§å‡½æ•°çš„å½¢å¼ï¼š
$Y_t = A_t K_t^\alpha L_t^{1-\alpha}$

å…¶ä¸­ï¼š
*   $Y_t$ æ˜¯ $t$ æ—¶æœŸçš„æ€»äº§å‡ºã€‚
*   $K_t$ æ˜¯ $t$ æ—¶æœŸæŠ•å…¥çš„èµ„æœ¬ã€‚
*   $L_t$ æ˜¯ $t$ æ—¶æœŸæŠ•å…¥çš„åŠ³åŠ¨ã€‚
*   $A_t$ æ˜¯ $t$ æ—¶æœŸçš„å…¨è¦ç´ ç”Ÿäº§çŽ‡ã€‚
*   $\alpha$ æ˜¯èµ„æœ¬çš„äº§å‡ºå¼¹æ€§ã€‚

åœ¨ä¼šè®¡å®žè·µä¸­ï¼Œå…¬å¸é€šå¸¸åœ¨è´¢å¹´æœ«æŠ«éœ²è´¢åŠ¡æŠ¥è¡¨ã€‚æ­¤æ—¶ï¼ŒæŠ¥å‘Šçš„â€œäº§å‡º ($Y_t$)â€é€šå¸¸æ˜¯æ•´ä¸ªå¹´åº¦çš„æ€»äº§å‡ºï¼Œâ€œåŠ³åŠ¨åŠ› ($L_t$)â€å¯èƒ½æ˜¯å¹´æœ«çš„é›‡å‘˜äººæ•°ï¼Œâ€œèµ„æœ¬ ($K_t$)â€ä¹Ÿå¯èƒ½æ˜¯å¹´æœ«çš„å­˜é‡ã€‚è¿™ç§æ•°æ®è®°å½•æ–¹å¼å¯èƒ½ä¼šå¯¼è‡´æŠ•å…¥ä¸Žäº§å‡ºä¹‹é—´åœ¨æ—¶é—´ä¸Šçš„é”™ä½ã€‚ä¾‹å¦‚ï¼Œæœ¬å¹´åº¦çš„äº§å‡ºå¯èƒ½æ›´å¤šåœ°ä¾èµ–äºŽå¹´åˆæˆ–ä¸Šä¸€å¹´åº¦æœ«çš„èµ„æœ¬å­˜é‡ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ `shift()` å‡½æ•°æ¥å°†ç›¸å…³çš„æŠ•å…¥å˜é‡è°ƒæ•´åˆ°åˆé€‚çš„æ—¶é—´èŠ‚ç‚¹ã€‚

å¯¹äºŽåŠ³åŠ¨åŠ›æŠ•å…¥ï¼Œç”±äºŽæˆ‘ä»¬ä¸ç¡®å®šæ˜¯æœŸæœ«å€¼ã€æœŸåˆå€¼è¿˜æ˜¯å¹³å‡å€¼èƒ½æœ€å‡†ç¡®åœ°è¡¡é‡å®žé™…æŠ•å…¥ï¼Œä¸€ç§å¸¸è§çš„å¤„ç†æ–¹æ³•æ˜¯å–å½“å¹´å’Œä¸Šä¸€å¹´çš„å¹³å‡åŠ³åŠ¨åŠ›ä½œä¸º $L_t$ çš„ä»£ç†å˜é‡ã€‚

!!! question "è¯¾å ‚ç»ƒä¹  3ï¼šç”Ÿäº§å‡½æ•°æ•°æ®å¤„ç†"
    æ–‡ä»¶ `cdprod.xlsx` (å‡è®¾) åŒ…å«äº†æŸè¡Œä¸šæˆ–å¤šå®¶å…¬å¸å¤šå¹´çš„é¢æ¿æ•°æ®ï¼Œå…¶ä¸­åŒ…æ‹¬äº§å‡º (output)ã€èµ„æœ¬å­˜é‡ (capital) å’ŒåŠ³åŠ¨åŠ›æŠ•å…¥ (labor) ç­‰å˜é‡ã€‚
    1.  è¯»å– `cdprod.xlsx` æ•°æ®ã€‚å‡è®¾æ•°æ®ä¸­å·²æœ‰æ—¶åºå’Œä¸ªä½“æ ‡è¯†ã€‚
    2.  ä¸ºäº†è§£å†³èµ„æœ¬æŠ•å…¥ä¸Žäº§å‡ºçš„æ—¶é—´é”™ä½é—®é¢˜ï¼Œä¸ºæ¯ä¸ªå…¬å¸åˆ›å»ºæ»žåŽä¸€æœŸçš„èµ„æœ¬å­˜é‡ï¼Œå³ $K_{t-1}$ã€‚ (æç¤º: å¯èƒ½éœ€è¦å…ˆæŒ‰å…¬å¸åˆ†ç»„ï¼Œå†è¿›è¡Œ `shift` æ“ä½œ)ã€‚
    3.  è®¡ç®—å¹³å‡åŠ³åŠ¨åŠ›æŠ•å…¥ã€‚ä¸€ç§å¸¸è§åšæ³•æ˜¯ä½¿ç”¨å½“æœŸåŠ³åŠ¨åŠ› $L_t$ å’Œä¸Šä¸€æœŸåŠ³åŠ¨åŠ› $L_{t-1}$ çš„å¹³å‡å€¼ï¼Œå³ $L_{avg,t} = (L_t + L_{t-1}) / 2$ã€‚åŒæ ·ï¼Œæ³¨æ„åœ¨é¢æ¿æ•°æ®ä¸­æŒ‰å…¬å¸åˆ†ç»„å¤„ç†ã€‚
    4.  ï¼ˆå¯é€‰ï¼‰å°†äº§å‡º $Y_t$ã€æ»žåŽèµ„æœ¬ $K_{t-1}$ã€å¹³å‡åŠ³åŠ¨ $L_{avg,t}$ å–è‡ªç„¶å¯¹æ•°ï¼Œä¸ºåŽç»­çš„çº¿æ€§å›žå½’åˆ†æžåšå‡†å¤‡ (å³ $\ln(Y_t) = \ln(A_t) + \alpha \ln(K_{t-1}) + (1-\alpha) \ln(L_{avg,t})$)ã€‚
    5.  å¤„ç†ç”±äºŽ `shift` æ“ä½œäº§ç”Ÿçš„ç¼ºå¤±å€¼ (NaN)ã€‚ä½ ä¼šå¦‚ä½•å¤„ç†å®ƒä»¬ï¼Ÿï¼ˆä¾‹å¦‚ï¼Œåˆ é™¤åŒ…å«NaNçš„è¡Œï¼Œæˆ–ä»…åœ¨è®¡ç®—ä¸­ä½¿ç”¨æœ‰æ•ˆæ•°æ®ï¼‰ã€‚

## æ•°æ®å¤„ç†ä¸Žåˆ†æžï¼šæ—¶é—´åºåˆ—æ“ä½œ

## å¤„ç† `shift` æ“ä½œäº§ç”Ÿçš„ç¼ºå¤±å€¼

åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ä½¿ç”¨ `shift` æ“ä½œæ¥è¿›è¡Œæ•°æ®çš„è¶…å‰æˆ–æ»žåŽå¤„ç†ã€‚ä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯ï¼Œ`shift` æ“ä½œä¼šåœ¨æ•°æ®çš„å¼€å¤´æˆ–ç»“å°¾äº§ç”Ÿç¼ºå¤±å€¼ (NaN)ã€‚

!!! question "æ€è€ƒä¸Žè®¨è®º"
    é’ˆå¯¹ `shift` æ“ä½œäº§ç”Ÿçš„ç¼ºå¤±å€¼ (NaN)ï¼Œä½ ä¼šå¦‚ä½•å¤„ç†å®ƒä»¬ï¼Ÿï¼ˆä¾‹å¦‚ï¼Œåˆ é™¤åŒ…å«NaNçš„è¡Œï¼Œæˆ–ä»…åœ¨è®¡ç®—ä¸­ä½¿ç”¨æœ‰æ•ˆæ•°æ®ï¼‰ã€‚

---

## ç¤ºä¾‹ï¼šç”Ÿäº§å‡½æ•°æ•°æ®

!!! info "èƒŒæ™¯çŸ¥è¯†ï¼šç”Ÿäº§å‡½æ•°ä¸Žæ•°æ®æ ¡å‡†"
    ç»æµŽå­¦ä¸­ï¼Œç”Ÿäº§å‡½æ•°æè¿°äº†æŠ•å…¥ä¸Žäº§å‡ºä¹‹é—´çš„å…³ç³»ã€‚ä¸€ä¸ªå¸¸è§çš„ç”Ÿäº§å‡½æ•°å½¢å¼æ˜¯æŸ¯å¸ƒ-é“æ ¼æ‹‰æ–¯ç”Ÿäº§å‡½æ•°ï¼š
    `ð‘Œð‘¡ = ð´ð‘¡ * ð¾ð‘¡^ð›¼ * ð¿ð‘¡^(1âˆ’ð›¼)`
    å…¶ä¸­ï¼š
    *   `ð‘Œð‘¡` æ˜¯æ—¶æœŸ `ð‘¡` çš„æ€»äº§å‡ºã€‚
    *   `ð´ð‘¡` æ˜¯æ—¶æœŸ `ð‘¡` çš„å…¨è¦ç´ ç”Ÿäº§çŽ‡ (Total Factor Productivity, TFP)ã€‚
    *   `ð¾ð‘¡` æ˜¯æ—¶æœŸ `ð‘¡` ä½¿ç”¨çš„èµ„æœ¬å­˜é‡ã€‚
    *   `ð¿ð‘¡` æ˜¯æ—¶æœŸ `ð‘¡` æŠ•å…¥çš„åŠ³åŠ¨é‡ã€‚
    *   `ð›¼` æ˜¯èµ„æœ¬çš„äº§å‡ºå¼¹æ€§ã€‚

    åœ¨ä¼šè®¡å®žè·µä¸­ï¼Œå…¬å¸é€šå¸¸åœ¨è´¢æ”¿å¹´åº¦æœ«æŠ«éœ²è´¢åŠ¡æŠ¥è¡¨ã€‚è¿™æ„å‘³ç€ï¼š
    *   äº§å‡º (`ð‘Œð‘¡`) é€šå¸¸æ˜¯æ•´ä¸ªå¹´åº¦çš„æ€»äº§å‡ºã€‚
    *   åŠ³åŠ¨ (`ð¿ð‘¡`) é€šå¸¸æ˜¯å¹´æœ«çš„å‘˜å·¥æ•°é‡ã€‚
    *   èµ„æœ¬ (`ð¾ð‘¡`) é€šå¸¸ä¹Ÿæ˜¯å¹´æœ«çš„èµ„æœ¬å­˜é‡ã€‚

    è¿™ç§æ•°æ®è®°å½•æ–¹å¼ä¼šå¯¼è‡´æŠ•å…¥å’Œäº§å‡ºä¹‹é—´çš„æ—¶é—´é”™ä½é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå½“æœŸäº§å‡º `ð‘Œð‘¡` æ›´æœ‰å¯èƒ½ä¾èµ–äºŽæœŸåˆæˆ–æœŸä¸­å¹³å‡çš„èµ„æœ¬å’ŒåŠ³åŠ¨æŠ•å…¥ï¼Œè€Œä¸æ˜¯æœŸæœ«å€¼ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Pandas ä¸­çš„ `shift()` å‡½æ•°æ¥æ ¡å‡†è¿™äº›æ•°æ®ï¼Œä½¿æŠ•å…¥å’Œäº§å‡ºåœ¨æ—¶é—´ä¸Šå¯¹é½ã€‚

    å¯¹äºŽåŠ³åŠ¨æŠ•å…¥ï¼Œç”±äºŽä¸ç¡®å®šä½¿ç”¨æœŸåˆã€æœŸæœ«è¿˜æ˜¯æœŸä¸­å¹³å‡å€¼èƒ½æ›´å‡†ç¡®åœ°è¡¡é‡ï¼Œé€šå¸¸ä¼šé‡‡ç”¨å½“å¹´å’Œä¸Šä¸€å¹´çš„å¹³å‡åŠ³åŠ¨é‡ä½œä¸º `ð¿ð‘¡` çš„ä»£ç†ã€‚

!!! question "è¯¾å ‚ç»ƒä¹  3ï¼šç”Ÿäº§å‡½æ•°æ•°æ®å¤„ç†"
    æ–‡ä»¶ `cdprod.xlsx` åŒ…å«äº†ä¸€å®¶è™šæ‹Ÿçš„èµ„æœ¬å¯†é›†åž‹ä¼ä¸šä»Ž2000å¹´åˆ°2021å¹´çš„èµ„æœ¬ã€åŠ³åŠ¨å’Œäº§å‡ºä¿¡æ¯ã€‚ä½†2000å¹´çš„äº§å‡ºæ•°æ®ç¼ºå¤±ã€‚

    1.  è¯·ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨ä¸æ ¡æ­£æ•°æ®æ—¶é—´é”™ä½çš„æƒ…å†µä¸‹ï¼Œä¼°ç®—èµ„æœ¬çš„äº§å‡ºå¼¹æ€§ `ð›¼`ã€‚
        *   **æç¤º**ï¼šä½ å¯ä»¥ç¼–å†™ä¸€ä¸ªå¾ªçŽ¯ï¼Œå°è¯•ä¸åŒçš„ `ð›¼` å€¼ï¼ˆä¾‹å¦‚ï¼Œä»Ž0åˆ°1ï¼Œæ­¥é•¿0.01ï¼‰ï¼Œæ‰¾å‡ºå“ªä¸ª `ð›¼` å€¼èƒ½ä½¿å¾—åŸºäºŽ `ð¾ð‘¡^ð›¼` è®¡ç®—å¾—åˆ°çš„åºåˆ—ä¸Žï¼ˆæŸç§æ ‡å‡†åŒ–æˆ–å˜æ¢åŽçš„ï¼‰äº§å‡ºåºåˆ— `ð‘Œð‘¡` æœ€æŽ¥è¿‘ã€‚ä¸€ç§ç®€åŒ–çš„æ€è·¯æ˜¯ï¼Œå¦‚æžœ `ð‘Œð‘¡/ð¿ð‘¡^(1âˆ’ð›¼) = ð´ð‘¡ * (ð¾ð‘¡/ð¿ð‘¡)^ð›¼` è¿‘ä¼¼æˆç«‹ï¼Œå¯ä»¥åˆ†æž `log(ð‘Œð‘¡/ð¿ð‘¡) = log(ð´ð‘¡) + ð›¼ * log(ð¾ð‘¡/ð¿ð‘¡)` çš„å…³ç³»ã€‚æ›´ç®€å•åœ°ï¼Œå¦‚æžœå‡è®¾ `ð´ð‘¡` å’Œ `ð¿ð‘¡` å½±å“ä¸å¤§ï¼Œæˆ–è€… `ð‘Œð‘¡ â‰ˆ ð¶ * ð¾ð‘¡^ð›¼`ï¼Œå¯ä»¥å°è¯•æ‹Ÿåˆè¿™ä¸ªå…³ç³»ã€‚

    2.  è¯·æ­£ç¡®æ ¡å‡†èµ„æœ¬å’ŒåŠ³åŠ¨æ•°æ®çš„æ—¶é—´åºåˆ—ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨æœŸåˆèµ„æœ¬ `ð¾ð‘¡-1` ä½œä¸ºå½“æœŸ `ð‘Œð‘¡` çš„æŠ•å…¥ï¼Œä½¿ç”¨å½“å¹´å’Œä¸Šä¸€å¹´çš„å¹³å‡åŠ³åŠ¨ `(ð¿ð‘¡ + ð¿ð‘¡-1)/2` ä½œä¸ºå½“æœŸæŠ•å…¥ï¼‰ï¼Œç„¶åŽé‡æ–°æ‰§è¡Œæ­¥éª¤1ï¼Œä¼°ç®—èµ„æœ¬çš„äº§å‡ºå¼¹æ€§ `ð›¼`ã€‚æ¯”è¾ƒä¸¤æ¬¡ä¼°ç®—çš„ç»“æžœã€‚

---

## ç¤ºä¾‹ï¼šé‡‘èžæ•°æ®

!!! info "èƒŒæ™¯çŸ¥è¯†ï¼šèµ„äº§å®šä»·ä¸­çš„åŠ¨é‡æ•ˆåº”"
    åœ¨èµ„äº§å®šä»·ç†è®ºä¸­ï¼Œâ€œåŠ¨é‡ (momentum)â€æ˜¯ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µã€‚å®ƒæŒ‡çš„æ˜¯è‚¡ç¥¨è¿‡åŽ»çš„æ”¶ç›ŠçŽ‡ä¿¡æ¯å¯ä»¥ä¸ºé¢„æµ‹å…¶æœªæ¥æ”¶ç›ŠçŽ‡æä¾›çº¿ç´¢ã€‚é€šå¸¸ï¼ŒåŠ¨é‡å› å­ `ð‘šð‘¡` å®šä¹‰ä¸ºè¿‡åŽ»ä¸€æ®µæ—¶é—´ï¼ˆä¸åŒ…æ‹¬æœ€è¿‘ä¸€ä¸ªæœˆï¼‰çš„ç´¯è®¡æ”¶ç›ŠçŽ‡ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¸¸ç”¨çš„åŠ¨é‡å®šä¹‰æ˜¯ï¼š
    `ð‘šð‘¡ = Î£(j=2 to 12) ð‘Ÿ(ð‘¡âˆ’ð‘—)`
    å…¶ä¸­ `ð‘Ÿð‘¡` æ˜¯èµ„äº§åœ¨æ—¶é—´ `ð‘¡` çš„æ”¶ç›ŠçŽ‡ã€‚è¿™ä¸ªå…¬å¼è®¡ç®—çš„æ˜¯ä»Ž `ð‘¡-12` åˆ° `ð‘¡-2` è¿™11ä¸ªæœˆçš„ç´¯è®¡æ”¶ç›ŠçŽ‡ã€‚

!!! question "è¯¾å ‚ç»ƒä¹  4ï¼šé‡‘èžæ•°æ®ä¸ŽåŠ¨é‡å› å­è®¡ç®—"
    1.  æ–‡ä»¶ `return1.csv` åŒ…å«äº†ä¸€å®¶å…¬å¸è‚¡ç¥¨çš„æ”¶ç›ŠçŽ‡ä¿¡æ¯ã€‚è¯·è®¡ç®—è¯¥å…¬å¸åœ¨æ•°æ®å¯å¾—æƒ…å†µä¸‹çš„æœˆåº¦åŠ¨é‡å› å­ã€‚
        *   **æç¤º**ï¼šä½ å¯èƒ½ä¼šå‘çŽ° Pandas çš„ `rolling()` æ–¹æ³•éžå¸¸æœ‰ç”¨ã€‚å…·ä½“æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨ `rolling(window=11).sum()` æ¥è®¡ç®—è¿‡åŽ»11æœŸï¼ˆå¯¹åº” `j=2` åˆ° `j=12` çš„11ä¸ªå€¼ï¼‰çš„å’Œï¼Œç„¶åŽå†ç”¨ `shift(1)` æ¥ç¡®ä¿æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ `t-12` åˆ° `t-2` çš„æ•°æ®æ¥é¢„æµ‹ `t` æˆ–è§£é‡Š `t-1`ã€‚å¯¹äºŽ `ð‘Ÿ(ð‘¡âˆ’ð‘—)`ï¼Œè‹¥è¦è®¡ç®— `ð‘šð‘¡`ï¼Œéœ€è¦ `ð‘Ÿ(ð‘¡-2)`, `ð‘Ÿ(ð‘¡-3)`, ..., `ð‘Ÿ(ð‘¡-12)`ã€‚

    2.  æ–‡ä»¶ `return4.csv` åŒ…å«äº†å››å®¶å…¬å¸è‚¡ç¥¨çš„æ”¶ç›ŠçŽ‡ä¿¡æ¯ã€‚
        1.  æŸ¥çœ‹æ•°æ®ï¼Œè®¡ç®—æ¯ä¸ªæ—¶é—´ç‚¹çš„æ¨ªæˆªé¢å¹³å‡æ”¶ç›ŠçŽ‡ (cross-sectional average returns)ã€‚ç„¶åŽï¼Œè®¡ç®—è¿™äº›æ¨ªæˆªé¢å¹³å‡æ”¶ç›ŠçŽ‡çš„æ—¶é—´åºåˆ—å¹³å‡å€¼ã€‚
        2.  è¯·è¯»å…¥æ•°æ®ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦éœ€è¦è¿›è¡Œä»»ä½•å¿…è¦çš„æ•°æ®æ¸…æ´—æˆ–è½¬æ¢ã€‚
        3.  è¯·è®¡ç®—è¿™å››å®¶å…¬å¸åœ¨æ•°æ®å¯å¾—æƒ…å†µä¸‹çš„æœˆåº¦åŠ¨é‡å› å­ã€‚

---

## ç¤ºä¾‹ï¼šå„å›½åˆ†è¡Œä¸šGDPæ•°æ®

!!! question "è¯¾å ‚ç»ƒä¹  5ï¼šå›½å®¶ä¸Žè¡Œä¸š GDP æ•°æ®åˆ†æž"
    æ–‡ä»¶ `country_sector.xlsx` åŒ…å«äº†å››ä¸ªå›½å®¶åœ¨ä¸åŒè¡Œä¸šçš„GDPæ•°æ®ã€‚
    è¯·åˆ†åˆ«è®¡ç®—ï¼š
    1.  æ¯ä¸ªå›½å®¶çš„æ€»å¹³å‡GDPï¼ˆè·¨è¡Œä¸šçš„å¹³å‡å€¼ï¼‰ã€‚
    2.  æ¯ä¸ªè¡Œä¸šçš„æ€»å¹³å‡GDPï¼ˆè·¨å›½å®¶çš„å¹³å‡å€¼ï¼‰ã€‚
    å¯ä»¥ä½¿ç”¨ Pandas çš„ `groupby()` å’Œ `mean()` æ–¹æ³•æ¥å®žçŽ°ã€‚
